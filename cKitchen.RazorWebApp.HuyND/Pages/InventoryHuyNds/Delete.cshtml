@page
@model cKitchen.RazorWebApp.HuyND.Pages.InventoryHuyNds.DeleteModel

@{
    ViewData["Title"] = "Delete";
}

<h1>Delete</h1>

<h3>Are you sure you want to delete this?</h3>
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-danger text-white">
                <h4 class="mb-0">Delete Inventory Item</h4>
            </div>

            <div class="card-body">
                <div class="alert alert-warning">
                    <strong>Warning!</strong> This action cannot be undone.
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="fw-semibold text-muted">Item Name</label>
                        <div class="form-control bg-light">
                            @Model.InventoryHuyNd.ItemName
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="fw-semibold text-muted">Quantity</label>
                        <div class="form-control bg-light">
                            @Model.InventoryHuyNd.Quantity @Model.InventoryHuyNd.Unit
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="fw-semibold text-muted">Expiry Date</label>
                        <div class="form-control bg-light">
                            @Model.InventoryHuyNd.ExpiryDate?.ToString("dd/MM/yyyy")
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="fw-semibold text-muted">Batch Number</label>
                        <div class="form-control bg-light">
                            @Model.InventoryHuyNd.BatchNumber
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="fw-semibold text-muted">Cost</label>
                        <div class="form-control bg-light">
                            @Model.InventoryHuyNd.Cost
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="fw-semibold text-muted">Status</label>
                        <div class="form-control bg-light">
                            @Model.InventoryHuyNd.Status
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="fw-semibold text-muted">Is Active</label>
                        <div class="form-control bg-light">
                            @(Model.InventoryHuyNd.IsActive == true ? "Active" : "Inactive")
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="fw-semibold text-muted">Location</label>
                        <div class="form-control bg-light">
                            @Model.InventoryHuyNd.InventoryLocationHuyNd?.LocationName
                        </div>
                    </div>
                </div>

                <form method="post" class="d-flex justify-content-end gap-2 mt-4">
                    <input type="hidden" asp-for="InventoryHuyNd.InventoryHuyNdid" />

                    <a asp-page="./Index" class="btn btn-outline-secondary">
                        Cancel
                    </a>

                    <button type="submit" class="btn btn-danger px-4">
                        Delete
                    </button>

                    <input type="button" id="btnDeleteSignalR" value="Delete by Signal" />
                </form>
            </div>
        </div>
    </div>
</div>


<script src ="~/js/signalr/dist/browser/signalr.js"> </script>
<script>
        "use strict";

    var connection = new signalR.HubConnectionBuilder().withUrl("/cKitchenHub").build();

    connection.start().then(function () {
        console.log("HuyND: Connected to the SignalR Hub");
    }).catch(function (err) {
        return console.error(err.toString());
    });

    document.getElementById("btnDeleteSignalR").addEventListener("click", function (event) {
        event.preventDefault();

        // Lấy ID và chuyển sang kiểu số trước khi gửi lên Hub
        var idValue = document.getElementById("InventoryHuyNd_InventoryHuyNdid").value;
        var inventoryId = parseInt(idValue, 10);

        if (isNaN(inventoryId)) {
            console.error("InventoryHuyNDId is not a valid number:", idValue);
            return;
        }

        console.log("Deleting InventoryHuyND with id:", inventoryId);

        connection.invoke("HubDelete_InventoryHuyND", inventoryId)
            .then(function () {
                // quay về trang Index
                window.location.href = "/InventoryHuyNds/Index";
            })
            .catch(function (err) {
                console.error(err.toString());
            });

    });
</script>

